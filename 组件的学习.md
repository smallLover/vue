### 组件的学习

#### 1.组件与模块的区别

联系：能够复用的具有一定功能的代码块。 		

区别：组件是UI层面的，模块是逻辑层面的。

#### 2.组件创建的三种方式

不论是那种方式创建出来的组件，组件的template 属性指向的模板内容，必须有且只能有唯一的一个根元素，template指向模板内容。不管哪一种都必须创建vue实例才能生效。

```
Vue.component("login","")
```

其中第一个是模板名称，第二个是模板内容。


1）使用vue.extend配合Vue.component方法，即使用extend创建模板内容。

```
var login  = Vue.extend({
 template:'<h1>登录</h1>'
})
Vue.component("login",login);
```

2) 直接使用Vue.component方法

```
Vue.component("login",{
	template:'<h1>登录'</h1>'
})
```

3) 将模板字符串定义到script标签中

通过字面量的形式定义了一个组件模板对象，好处在于可以有代码自动补齐

```
<template id="tep1">
        <div>
            <h1>这是第二种</h1>
        </div>
</template>
//全局 
Vue.component("login",{
    template:'#tmp1'
})
//私有
var tem = new Vue({
	el:'app',
	components:{
	login:{
	 template:'#tmp1'
	}
})
```

#### 3.组件中的data为啥是个function

```
Vue.compnent ("login",{
	template:'#tmp1',
	data:function(){
	return {}
})
```

返回一个新的数据对象而不是一个地址，若直接是一个对象的话，所有组件将共享这个数据，某一个组件变化，则所有组件的数据都会发生变化。

#### 4.组件的切换

两种组件的切换方式：

1）使用v-if的方式

```
<div id = "app">
	<login v-if="flag"></login>
	<register v-if = "!flag"></register>
</div>
<script>
Vue.component("login",{
	template:'<h1>登录</h1>'
})
Vue.component("register",{
	template:'<h1>注册</h1>'
})
var vm = new Vue( {
    el:"app",
    data:{
    flag:true
    }
})
</script>
```

2) 使用Vue提供的component元素,这里component是一个占位符，：is显示要展示的组件名称

```
<div id = "app">
	<component :is="login"></component>
</div>
<script>
    Vue.component("login",{
        template:'<h1>登录</h1>'
    })
    Vue.component("register",{
        template:'<h1>注册</h1>'
    })
    var vm = new Vue( {
        el:"app",
        data:{
        flag:true
        }
    })
</script>
```

#### 5.组件的自定义属性

##### 5.1基本用法

组件在注册的时候可以自定义属性，在使用的时候可以用。props中就是自定义的属性的名称,若名称使用驼峰命名，则在使用的时候用-将大小写隔开。

```
 //定义
 var register = Vue.component("register", {
            props: ["name"],
            template: '<h1>这是{{name}}</h1>',
        })
 //使用
 <register name="自定义属性"></register>
```

```
 //定义
 var register = Vue.component("register", {
            props: ["nameProp"],
            template: '<h1>这是{{name}}</h1>',
        })
 //使用
 <register name-prop="自定义属性"></register>
```

属性也可以指定类型

```
 props: { name: String, title: Number },
```

##### 5.2动态传值

自定义属性可以通过v-bind动态进行传值

```
<register v-bind:name="post.name"></register>
```

单向下行绑定：父级 prop 的更新会向下流动到子组件中，但是反过来则不行。这样会防止从子组件意外变更父级组件的状态，从而导致你的应用的数据流向难以理解。

```
props: ['initialCounter'],
data: function () {
  return {
    counter: this.initialCounter
  }
}
```

##### 5.3 prop的验证

```
Vue.component('my-component', {
  props: {
    // 基础的类型检查 (`null` 和 `undefined` 会通过任何类型验证)
    propA: Number,
    // 多个可能的类型
    propB: [String, Number],
    // 必填的字符串
    propC: {
      type: String,
      required: true
    },
    // 带有默认值的数字
    propD: {
      type: Number,
      default: 100
    },
    // 带有默认值的对象
    propE: {
      type: Object,
      // 对象或数组默认值必须从一个工厂函数获取
      default: function () {
        return { message: 'hello' }
      }
    },
    // 自定义验证函数
    propF: {
      validator: function (value) {
        // 这个值必须匹配下列字符串中的一个
        return ['success', 'warning', 'danger'].indexOf(value) !== -1
      }
    }
  }
})
```



#### 6.组件传值

##### 6.1父组件向子组件传值

通过属性绑定的形式将父组件的值传递到子组件,通过事件绑定v-on传递方法也能进行传值 。

```
//div是父组件  
<div id = "app">
	<com1 v-bind:parentmsg="msg"> </com1>
</div>
<script>
    var vm = new Vue( {
        el:"app",
        data:{
        flag:true
        msg:"这是父组件"
        }
        componets:{
        com1:{
        template:"<h1>这是子组件</h1>"
        }
        }
    })
</script>
```

##### 6.2子组件向父组件传值

通过事件调用向父组件传值，过程：

1）首先父组件通过事件绑定的机制向子组件绑定一个方法，即父组件向子组件传递一个方法

2）子组件虽然收到了父组件的方法，但是没有执行

3）在子组件的事件方法中调用传递过来的方法。

```
<div id = "app">
	//父组件向子组件传递方法  show是一个方法的引用 show()表示方法执行完成的结果传给func
	<com2  @func="show"> </com2>
<div>
//组件com2的模板
<template id = "tmp1">
	<div>
		<h1>这是子组件</h1>
		//子组件拿到了父组件的方法，但是没有调用，真正调用是在myclick方法中
		<input type = "button" value = "这是子组件中的按钮 " @click = "myclick">
	</div>
<template>
<script>
	//定义一个字面量类型的组件模板对象
	var a = Vue.component({
	template:"#tmp1"
	methods:{
		myclick:{
		//当点击子组件的按钮的时候,如何拿到父组件传过来的func方法，并调用.
		//emit表示调用、执行的意思
		  this.$emit("func")
		}
	}
	var vm = new Vue(
		{
			el:"app"
			methods:{
			show:{
			console.log("父组件")
			}
			}
		}
	
	)
})
```

之所以要用这种方式进行传递事件是因为子组件和父组件都有自己的作用域，只能调用自己内部的方法。